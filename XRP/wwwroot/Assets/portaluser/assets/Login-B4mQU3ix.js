import{d as u,r as p,u as g,B as e,c as m,a as f,b as k,P as y,o as h}from"./index-CjL5zVX3.js";const v={class:"container--centered"},C=["label"],b=u({__name:"Login",setup(R){var a,i,c,r,l;const t=p(""),o={carrier:g().carrierCode};(a=e.storage.id_token_claims)!=null&&a.customer_code&&(o.entity_type="customer",o.entity_code=(i=e.storage.id_token_claims)==null?void 0:i.customer_code),((c=e.storage.access_token_claims)==null?void 0:c.accessType)==="internal"&&(o.office=(r=e.storage.id_token_claims)==null?void 0:r.office,o.country=(l=e.storage.id_token_claims)==null?void 0:l.country);const _=o,d={response_type:"code",...o},s=()=>{t.value="Redirecting to login page...",y.loginRedirect({scopes:["openid","profile","email"],response_type:"code"})};return(async()=>{if(e.isTokenValid("refresh_token")){let n=null;try{t.value="Checking for session...",n=await e.refreshTokens(_)}catch{try{t.value="Requesting new session...",n=await e.getTokenSilently(d)}catch{s();return}}finally{n?(t.value="Completing login...",m(n)):(t.value="Completing login...",s())}}else t.value="Completing login...",s()})(),(n,B)=>(h(),f("div",v,[k("mc-loading-indicator",{variant:"spinner",label:t.value},null,8,C)]))}});export{b as default};
